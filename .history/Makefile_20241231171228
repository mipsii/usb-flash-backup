POT_FILE = messages.pot
PO_DIR = locale
LANGUAGES = sr cz en
MO_FILES = $(foreach lang, $(LANGUAGES), $(PO_DIR)/$(lang)/LC_MESSAGES/app.mo)
PO_FILES = $(foreach lang, $(LANGUAGES), $(PO_DIR)/$(lang)/LC_MESSAGES/app.po)

all: $(MO_FILES)

$(POT_FILE):
	py_files=$$(find . -maxdepth 1 -name '*.py'); \
	if [ -n "$$py_files" ]; then \
	  xgettext --keyword=_ --from-code=UTF-8 -o $(POT_FILE) $$py_files; \
	else \
	  echo "No Python files found."; \
	fi

# Automatsko kopiranje i pravljenje po fajlova ako ne postoje
$(PO_DIR)/%/LC_MESSAGES/app.po: $(POT_FILE)
	@mkdir -p $(dir $@)
	cp $(POT_FILE) $@

# Kompajliranje u .mo fajlove
$(PO_DIR)/%/LC_MESSAGES/app.mo: $(PO_DIR)/%/LC_MESSAGES/app.po
	msgfmt $< -o $@

clean:
	rm -f $(POT_FILE)
	rm -f $(MO_FILES)
	rm -f $(PO_FILES)
